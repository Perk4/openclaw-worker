# 2026-02-07 Session Notes

## Satin Shield - Full Content Pipeline ‚úÖ

### Session Summary
1. ‚úÖ Deployed Worker API (v0.3.0-tts)
2. ‚úÖ TTS voiceover with OpenAI (6 voices)
3. ‚úÖ Product image generation with Gemini
4. ‚úÖ Dashboard with 4 tabs: Scripts, Products, Library, Videos

### What We Built

**1. Worker API Deployed**
- URL: `https://satin-shield-content-engine.prtl.workers.dev`
- Endpoints:
  - `GET /health` - Health check
  - `GET /api/videos` - List videos from R2
  - `GET /api/content` - List generated scripts/jobs
  - `POST /api/content` - Generate new script
  - `GET /api/content/:jobId` - Get job status

**2. Script Generation**
- Claude API integration for UGC-style scripts
- Supports 4 templates: TalkingHead, ProductShowcase, EducationalExplainer, TrendResponse
- 5 content pillars: fear, lifestyle, social-proof, product-demo, community
- 3 platforms: TikTok, Instagram, YouTube
- Optional custom hook override

**3. Dashboard Controls**
- New tabbed UI: Gallery | Create | Scripts
- Create tab: Full content generation form
  - Template selector with icons
  - Content pillar selector
  - Platform selector
  - Custom hook input
- Scripts tab: View all generated scripts with status
- Gallery now fetches videos from API dynamically

### Technical Notes

- Used R2 for job persistence (jobs stored as `jobs/{id}.json`)
- KV namespace creation failed - API token lacks permissions
- Queue `content-generation` was created but not wired up yet (MVP is synchronous)
- CORS enabled for `satin-shield.pages.dev` and localhost dev

### Live URLs
- Dashboard: https://satin-shield.pages.dev
- API: https://satin-shield-content-engine.prtl.workers.dev

### TTS Integration Added ‚úÖ
- OpenAI TTS integrated into Worker (v0.3.0-tts)
- 6 voices: nova, shimmer, alloy, echo, fable, onyx
- Audio stored in R2 at `audio/{jobId}.mp3`
- Dashboard updated with voice selector + audio player
- Gemini TTS researched as alternative (gemini-2.5-flash-preview-tts)

### Product Image Generation Added ‚úÖ
- Gemini image generation (`gemini-2.0-flash-exp-image-generation`)
- Claude generates optimized prompts from product spec
- Reference image upload support
- 4 styles: photorealistic, editorial, minimal, vibrant
- Images stored in R2 at `product-images/{jobId}-{n}.png`
- New Products tab in dashboard

### Hedra Avatar Integration Added ‚úÖ
- Hedra Character-3 API for talking head videos
- Upload photo + script ‚Üí generates lip-synced avatar video
- TTS with OpenAI, then uploaded to Hedra
- Videos stored in R2 at `avatars/{jobId}.mp4`
- New Avatar tab in dashboard
- Expression/gesture prompt support

### Session Complete
All major features now implemented:
- ‚úÖ Script generation (Claude)
- ‚úÖ TTS voiceover (OpenAI)  
- ‚úÖ Product images (Gemini)
- ‚úÖ Avatar videos (Hedra)

### Next Steps
- Wire up audio + avatar into Remotion templates for final video rendering
- Remotion Lambda for faster parallel rendering
- Add KV permissions to API token for proper job queue

---

## Session 2: Product Shots UX Improvements

### Steven's Feedback
**Good:** Product spec ‚Üí image ref ‚Üí scenes (one per line) flow is great UX ‚úÖ

**Issues Fixed:**
1. Images opened in new tabs ‚Üí Now have in-app lightbox viewer
2. No image management ‚Üí Added keep/delete/regenerate actions

### What We Built

**Lightbox Image Viewer**
- Click any image ‚Üí opens modal overlay
- Arrow key navigation (‚Üê/‚Üí/Esc)
- Counter showing position (1/4, 2/4, etc.)
- Shows the prompt that generated each image

**Image Management Actions**
- ‚úì Keep - marks good images (green border + badge)
- üóëÔ∏è Delete - hides bad images from view  
- üîÑ Regenerate - creates new image with same prompt

**Backend**
- Added `/api/product-images/regenerate` endpoint
- Takes prompt + optional reference image, returns new imageUrl

### Commits
- `319d1a7` - Add lightbox image viewer + keep/delete/regenerate actions
- `a1c4ead` - trigger: rebuild after fix (empty commit to force Pages deploy)

### Roadmap (Not Started)
- Multiple reference images (low effort)
- "Like" to train style preferences (high effort - could use liked images as refs)

### Next Session
- Test Avatar tab (Hedra integration)
